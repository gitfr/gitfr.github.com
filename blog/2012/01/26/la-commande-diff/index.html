


<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    
  <title>#gitfr</title>
<link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="http://feeds.feedburner.com/gitfr" />
<link rel='stylesheet' href='/css/pygments_tango.css' type='text/css' />

<link rel='stylesheet' href='/css/pygments_murphy.css' type='text/css' />
<link rel='stylesheet' href='/css/pygments_tango.css' type='text/css' />
<link rel='stylesheet' href='/css/site.css' type='text/css' />
<link rel='stylesheet' href='/css/documentation.css' type='text/css' />
<link rel='stylesheet' href='/css/jquery.tweet.css' type='text/css' />

<script type="text/javascript" src="/js/jquery-1.4.2.min.js"></script>
<script type="text/javascript" src="/js/jquery.tweet.js"></script>
<script type="text/javascript" src="/js/googleRSSWidget.js"></script>
<script type="text/javascript" src="/js/site.js"></script>



  </head>
  <body>
    <div id="content">
      
  
<div id="header" onclick="location.href='/';" style="cursor: pointer;">
  <div id="plugbanner"></div>
  <div id="blog_logo"></div>
  <h1><a href="/">
      <span id="blog_name">
        #gitfr
      </span>
    </a>
  </h1>
</div>
<a href="http://github.com/gitfr/website"><img style="position: absolute; top: 0; right: 0; border: 0;" src="http://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub" /></a>
<div id="top_bar">
  <div class="ButtonBar">
    <ul>
      <li><a href="/">Accueil</a></li>
      <li><a href="/blog">Blog</a></li>
    </ul>
  </div>
  <div id="search">    
    <form id="searchform" method="get" action="http://www.google.com/search">
      <input type="hidden" name="ie" value="UTF-8">
      <input type="hidden" name="oe" value="UTF-8">
      <input type="hidden" name="domains" value="www.gitfr.net">
      <input type="hidden" name="sitesearch" value="www.gitfr.net">
      <input name="q" id="q" size="20" value="recherche..." onfocus="if(this.value==this.defaultValue) this.value='';" type="text">
    </form>
  </div>
</div>



      <div id="main_block">
        <div id="prose_block">
          

<div class="blog_post">
  <a name="la-commande-diff"></a>
  <h2 class="blog_post_title"><a href="/blog/2012/01/26/la-commande-diff" rel="bookmark" title="Permanent Link to La commande diff">La commande diff</a></h2>
  <p class="related"><strong>26/01/2012 03:48 PM</strong> | categories: 

<a href='/blog/category/git-git-diff'>git git-diff</a>
 | <a href="http://www.gitfr.net/blog/2012/01/26/la-commande-diff#disqus_thread">Commentaires</a>
<p/>
  <div class="post_prose">
    
  <p>Vous connaissez surement la commande <code>git-diff</code>, puisqu'elle existe sur Hg ou
SVN. Mais comme d'habitude, git fourmille de possibilités. Petit tour
d'horizon.</p>
<h2>Le base</h2>
<p>Commençons par le basique. Pour connaître les différences entre votre
répertoire de travail et votre index :</p>
<blockquote>
<p>$ git diff</p>
</blockquote>
<p>Entre l'index et votre dépôt :</p>
<blockquote>
<p>$ git diff --staged</p>
</blockquote>
<p>Entre le répertoire de travail et le dépôt :</p>
<blockquote>
<p>$ git diff HEAD</p>
</blockquote>
<p><strong>Note</strong> : la notation HEAD se retrouve assez souvent (git-log, git-reset...)
quand on parle du dépôt, vu qu'il s'agit du commit courant, c'est à dire notre
position sur le graphe (l'index étant le prochain commit).</p>
<p>La commande permet de spécifier des fichiers ou des commits (ces deux
possibilités peuvent être combinées) :</p>
<blockquote>
<p>$ git diff -- monfichier</p>
<p>$ git diff commit</p>
</blockquote>
<p>Si vous voulez connaître la différence entre 2 commits :</p>
<blockquote>
<p>$ git diff commit1 commit2 </p>
</blockquote>
<p>Plus intéressant, si vous voulez savoir ce qui existe dans une branche et pas
dans l'autre :</p>
<blockquote>
<p>$ git diff commit1...commit2</p>
</blockquote>
<p>Cela se lit comme suit : affiche moi ce qui existe entre l'ancêtre commun aux
deux commits jusqu'au commit2 qui n'existe pas de l'ancêtre commun au commit1.</p>
<h2>Le contexte</h2>
<p>Par défaut, Git vous propose un contexte de 3 lignes, c'est à dire qu'il
affiche 3 lignes supplémentaires en dessous des changements pour vous donner
plus d'indications. Si vous trouvez cela insuffisant, voici 2 techniques
possibles :</p>
<ol>
<li>La 1ère est bien sûr d'augmenter le contexte avec l'option <code>-U</code></li>
</ol>
<blockquote>
<p>$ git diff -U5</p>
</blockquote>
<p>Pensez à faire un alias si vous préférez toujours disposer d'un contexte d'une
taille différente.</p>
<ol>
<li>Demander à Git la fonction qui contient la modification</li>
</ol>
<blockquote>
<p>$ git diff -W</p>
</blockquote>
<p>C'est une nouveauté de la version 1.7.8. Vu le nombre impressionnant de
langages il n'est pas sûr que Git se débrouille correctement mais d'après mes
premiers tests en Python, cela semble plûtot bien fonctionner.</p>
<h2>Ignorer les espaces</h2>
<p>Il est désagréable de voir son diff pourri parce qu'un collègue à aussi
supprimer des espaces. Vous avez à votre disposition les options <code>-b</code> <code>-w</code> pour
ignorer les espaces en fin de lignes ou toutes les espaces.</p>
<h2>Algorithme patience</h2>
<p>La commande implémente aussi un autre algorithme de détection de changement du
nom de <em>Patience</em>. Pour faire très court, cet algo se focalise uniquement sur
des lignes à fort contenu, alors que l'algorithme classique travaille sur
toutes les lignes. Il y'a des cas ou c'est intéressant de l'essayer (notamment
quand le diff classique est complètement perdu).</p>
<p><strong>Note</strong> : pour de plus amples explications, veuillez vous référer à cette
page <a href="http://bryanpendleton.blogspot.com/2010/05/patience-diff.html">ci</a> et à
celle <a href="http://alfedenzo.livejournal.com/170301.html">la</a>.</p>
<h2>Faire des statistiques</h2>
<p>Je vous laisse regarder par vous même les options <code>--stat</code>, <code>--numstat</code>,
<code>--shortstat</code>, <code>--dirstat</code> et <code>--summary</code> :).</p>
<h2>Afficher les différences sur la même ligne</h2>
<p>Il est intéressant, par exemple pour de la documentation, d'afficher les
modifications sur la même ligne. C'est tout l'intérêt du mode <em>word diff</em>.</p>
<blockquote>
<p>$ git diff --word-diff</p>
</blockquote>
<h2>Ne pas afficher les prefixes</h2>
<p>Ne pas afficher les a/ et b/, utilise quand on fait des copier / coller :</p>
<blockquote>
<p>$ git diff --no-prefix</p>
</blockquote>
<h2>Chercher une chaine dans le contenu</h2>
<p>Si vous cherchez une chaine particulière dans le contenu d'un commit (cad les
lignes qui ont été ajoutées ou supprimées), c'est l'option pickaxe qu'il vous
faut :</p>
<blockquote>
<p>$ git diff -Srenderer HEAD~10..HEAD</p>
</blockquote>
<p>Vous pouvez utiliser une expression rationnelle avec l'option <code>-G</code>.</p>
<p><strong>Note</strong> : l'option <code>--pickaxe-all</code> affiche l'ensemble du commit, et pas
uniquement les fichiers impactés.</p>
<h2>Générer un patch</h2>
<p>Le comportement par défaut de Git est de générer un patch :</p>
<blockquote>
<p>$ git diff &gt; diff.patch</p>
</blockquote>
<h2>Et encore plein d'autres options</h2>
<p>Comme d'habitude, je vous recommande chaudement de lire le manuel de la
commande tellement Git regorge d'options (notamment pour aider au scripting).
Je n'ai pas parlé de l'option <code>--check</code> pour vérifier les espaces inutiles, le
<code>-M</code> et le <code>-C</code> pour détecter copie et déplacement...</p>

  </div>
</div>



<div id="disqus_thread"></div>
<script type="text/javascript">
  var disqus_url = "http://www.gitfr.net/blog/2012/01/26/la-commande-diff";
</script>
<script type="text/javascript" src="http://disqus.com/forums/gitfr/embed.js"></script>
<noscript><a href="http://gitfr.disqus.com/?url=ref">View the discussion thread.</a></noscript><a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>

        </div><!-- End Prose Block -->
        
  <div class="right_sidebar">
    <div id="right_sidebar">
  <div id="rss">
    <h2>flux RSS</h2>
    <a href="http://feeds.feedburner.com/gitfr">billets</a>
    /
    <a href="http://gitfr.disqus.com/latest.rss">commentaires</a>
  </div>
  <div id="contact">
    <h2>Contact</h2>
    mail : seb@gitfr.net<br />
    liste de diffusion : <a href="http://groups.google.com/group/gitfr">gitfr</a><br />
    IRC : #git-fr sur Freenode
  </div>
  <div id="blog_post_list">
    <h2>Derniers billets</h2>
    <ul>
    <li><a href="/blog/2013/01/06/git-1.8.0-publiee">Git 1.8.0 publiée</a></li>
    <li><a href="/blog/2012/10/19/presentation-et-atelier-git-le-24-et-25-a-toulouse">Présentation et atelier Git le 24 et 25/11 à Toulouse</a></li>
    <li><a href="/blog/2012/10/19/gitfr-recherche-un-repreneur">gitfr recherche un repreneur (ou simplement des bloggeurs)</a></li>
    <li><a href="/blog/2012/08/24/git-1.7.12-publiee">Git 1.7.12 publiée</a></li>
    <li><a href="/blog/2012/07/01/retour-sur-le-breizhcamp-2012">Retour sur le BreizhCamp 2012</a></li>
    <li><a href="/blog/2012/07/01/git-1.7.11-publiee">Git 1.7.11 publiée</a></li>
    <li><a href="/blog/2012/04/15/git-1.7.10-publiee">Git 1.7.10 publiée</a></li>
    <li><a href="/blog/2012/03/30/presentation-git-le-12-04-a-lausanne">Présentation Git le 12/04 à Lausanne</a></li>
  </ul>
  </div>
  <div id="on_twitter">
    <h3>Sur Twitter</h2>
    <div id="blogofile_tweets"></div>
    <a href="http://twitter.com/gitfr" style="float: right">Plus de tweets</a>
  </div>
  <div id="categories">
    <h2>Categories</h2>
    <ul>
     <li><a href="/blog/category/astuce">astuce</a> (<a href="/blog/category/astuce/feed">rss</a>) (1)</li>
     <li><a href="/blog/category/atelier">atelier</a> (<a href="/blog/category/atelier/feed">rss</a>) (24)</li>
     <li><a href="/blog/category/configuration">configuration</a> (<a href="/blog/category/configuration/feed">rss</a>) (7)</li>
     <li><a href="/blog/category/git">git</a> (<a href="/blog/category/git/feed">rss</a>) (58)</li>
     <li><a href="/blog/category/git-git-diff">git git-diff</a> (<a href="/blog/category/git-git-diff/feed">rss</a>) (1)</li>
     <li><a href="/blog/category/git-add">git-add</a> (<a href="/blog/category/git-add/feed">rss</a>) (1)</li>
     <li><a href="/blog/category/git-checkout">git-checkout</a> (<a href="/blog/category/git-checkout/feed">rss</a>) (1)</li>
     <li><a href="/blog/category/git-clone">git-clone</a> (<a href="/blog/category/git-clone/feed">rss</a>) (2)</li>
     <li><a href="/blog/category/git-commit">git-commit</a> (<a href="/blog/category/git-commit/feed">rss</a>) (1)</li>
     <li><a href="/blog/category/git-fetch">git-fetch</a> (<a href="/blog/category/git-fetch/feed">rss</a>) (1)</li>
     <li><a href="/blog/category/git-init">git-init</a> (<a href="/blog/category/git-init/feed">rss</a>) (1)</li>
     <li><a href="/blog/category/git-pull">git-pull</a> (<a href="/blog/category/git-pull/feed">rss</a>) (2)</li>
     <li><a href="/blog/category/git-push">git-push</a> (<a href="/blog/category/git-push/feed">rss</a>) (2)</li>
     <li><a href="/blog/category/git-remote">git-remote</a> (<a href="/blog/category/git-remote/feed">rss</a>) (1)</li>
     <li><a href="/blog/category/git-reset">git-reset</a> (<a href="/blog/category/git-reset/feed">rss</a>) (1)</li>
     <li><a href="/blog/category/git-revert">git-revert</a> (<a href="/blog/category/git-revert/feed">rss</a>) (1)</li>
     <li><a href="/blog/category/git-rm">git-rm</a> (<a href="/blog/category/git-rm/feed">rss</a>) (1)</li>
     <li><a href="/blog/category/gitfr">gitfr</a> (<a href="/blog/category/gitfr/feed">rss</a>) (32)</li>
     <li><a href="/blog/category/github">github</a> (<a href="/blog/category/github/feed">rss</a>) (11)</li>
     <li><a href="/blog/category/google-code">google code</a> (<a href="/blog/category/google-code/feed">rss</a>) (1)</li>
     <li><a href="/blog/category/hg">hg</a> (<a href="/blog/category/hg/feed">rss</a>) (1)</li>
     <li><a href="/blog/category/installation">installation</a> (<a href="/blog/category/installation/feed">rss</a>) (3)</li>
     <li><a href="/blog/category/macos">macos</a> (<a href="/blog/category/macos/feed">rss</a>) (2)</li>
     <li><a href="/blog/category/migration">migration</a> (<a href="/blog/category/migration/feed">rss</a>) (6)</li>
     <li><a href="/blog/category/outil">outil</a> (<a href="/blog/category/outil/feed">rss</a>) (4)</li>
     <li><a href="/blog/category/refspec">refspec</a> (<a href="/blog/category/refspec/feed">rss</a>) (2)</li>
     <li><a href="/blog/category/release">release</a> (<a href="/blog/category/release/feed">rss</a>) (23)</li>
     <li><a href="/blog/category/traduction">traduction</a> (<a href="/blog/category/traduction/feed">rss</a>) (1)</li>
     <li><a href="/blog/category/ubuntu">ubuntu</a> (<a href="/blog/category/ubuntu/feed">rss</a>) (1)</li>
     <li><a href="/blog/category/windows">windows</a> (<a href="/blog/category/windows/feed">rss</a>) (2)</li>
    </ul>
  </div> 
  <div id="archives">			
    <h2>Archives</h2>
    <ul>
      <li><a href="/blog/archive/2013/01/1" title="January 2013">January 2013</a>&nbsp;(1)</li>
      <li><a href="/blog/archive/2012/10/1" title="October 2012">October 2012</a>&nbsp;(2)</li>
      <li><a href="/blog/archive/2012/08/1" title="August 2012">August 2012</a>&nbsp;(1)</li>
      <li><a href="/blog/archive/2012/07/1" title="July 2012">July 2012</a>&nbsp;(2)</li>
      <li><a href="/blog/archive/2012/04/1" title="April 2012">April 2012</a>&nbsp;(1)</li>
      <li><a href="/blog/archive/2012/03/1" title="March 2012">March 2012</a>&nbsp;(1)</li>
      <li><a href="/blog/archive/2012/02/1" title="February 2012">February 2012</a>&nbsp;(2)</li>
      <li><a href="/blog/archive/2012/01/1" title="January 2012">January 2012</a>&nbsp;(4)</li>
      <li><a href="/blog/archive/2011/12/1" title="December 2011">December 2011</a>&nbsp;(5)</li>
      <li><a href="/blog/archive/2011/10/1" title="October 2011">October 2011</a>&nbsp;(7)</li>
      <li><a href="/blog/archive/2011/09/1" title="September 2011">September 2011</a>&nbsp;(1)</li>
      <li><a href="/blog/archive/2011/08/1" title="August 2011">August 2011</a>&nbsp;(2)</li>
      <li><a href="/blog/archive/2011/07/1" title="July 2011">July 2011</a>&nbsp;(5)</li>
      <li><a href="/blog/archive/2011/06/1" title="June 2011">June 2011</a>&nbsp;(6)</li>
      <li><a href="/blog/archive/2011/05/1" title="May 2011">May 2011</a>&nbsp;(2)</li>
      <li><a href="/blog/archive/2011/04/1" title="April 2011">April 2011</a>&nbsp;(23)</li>
      <li><a href="/blog/archive/2011/03/1" title="March 2011">March 2011</a>&nbsp;(4)</li>
      <li><a href="/blog/archive/2011/02/1" title="February 2011">February 2011</a>&nbsp;(3)</li>
      <li><a href="/blog/archive/2011/01/1" title="January 2011">January 2011</a>&nbsp;(1)</li>
      <li><a href="/blog/archive/2010/12/1" title="December 2010">December 2010</a>&nbsp;(12)</li>
      <li><a href="/blog/archive/2010/11/1" title="November 2010">November 2010</a>&nbsp;(12)</li>
      <li><a href="/blog/archive/2010/10/1" title="October 2010">October 2010</a>&nbsp;(3)</li>
    </ul>
  </div>
  <div id="credits">
    <h2>Crédits</h2>
    Propulsé par <a href="http://www.blogofile.com">Blogofile</a>
  </div>

</div>

  </div>

      </div><!-- End Main Block -->
    </div> <!-- End Content -->

    <script type="text/javascript">
  
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-19444937-1']);
        _gaq.push(['_trackPageview']);

        (function() {
            var ga = document.createElement('script');
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            ga.setAttribute('async', 'true');
            document.documentElement.firstChild.appendChild(ga);
        })();

    </script>
  </body>
</html>





