


<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    
  <title>#gitfr</title>
<link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="http://feeds.feedburner.com/gitfr" />
<link rel='stylesheet' href='/css/pygments_tango.css' type='text/css' />

<link rel='stylesheet' href='/css/pygments_murphy.css' type='text/css' />
<link rel='stylesheet' href='/css/pygments_tango.css' type='text/css' />
<link rel='stylesheet' href='/css/site.css' type='text/css' />
<link rel='stylesheet' href='/css/documentation.css' type='text/css' />
<link rel='stylesheet' href='/css/jquery.tweet.css' type='text/css' />

<script type="text/javascript" src="/js/jquery-1.4.2.min.js"></script>
<script type="text/javascript" src="/js/jquery.tweet.js"></script>
<script type="text/javascript" src="/js/googleRSSWidget.js"></script>
<script type="text/javascript" src="/js/site.js"></script>



  </head>
  <body>
    <div id="content">
      
  
<div id="header" onclick="location.href='/';" style="cursor: pointer;">
  <div id="plugbanner"></div>
  <div id="blog_logo"></div>
  <h1><a href="/">
      <span id="blog_name">
        #gitfr
      </span>
    </a>
  </h1>
</div>
<a href="http://github.com/gitfr/website"><img style="position: absolute; top: 0; right: 0; border: 0;" src="http://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub" /></a>
<div id="top_bar">
  <div class="ButtonBar">
    <ul>
      <li><a href="/">Accueil</a></li>
      <li><a href="/blog">Blog</a></li>
    </ul>
  </div>
  <div id="search">    
    <form id="searchform" method="get" action="http://www.google.com/search">
      <input type="hidden" name="ie" value="UTF-8">
      <input type="hidden" name="oe" value="UTF-8">
      <input type="hidden" name="domains" value="www.gitfr.net">
      <input type="hidden" name="sitesearch" value="www.gitfr.net">
      <input name="q" id="q" size="20" value="recherche..." onfocus="if(this.value==this.defaultValue) this.value='';" type="text">
    </form>
  </div>
</div>



      <div id="main_block">
        <div id="prose_block">
          
  
<div class="blog_post">
  <a name="comportement-par-defaut-du-git-push"></a>
  <h2 class="blog_post_title"><a href="/blog/2011/12/11/comportement-par-defaut-du-git-push" rel="bookmark" title="Permanent Link to Comportement par défaut du git push">Comportement par défaut du git push</a></h2>
  <p class="related"><strong>11/12/2011 11:19 PM</strong> | categories: 

<a href='/blog/category/git-pull'>git-pull</a>, <a href='/blog/category/git-push'>git-push</a>, <a href='/blog/category/git'>git</a>, <a href='/blog/category/refspec'>refspec</a>, <a href='/blog/category/configuration'>configuration</a>
 | <a href="http://www.gitfr.net/blog/2011/12/11/comportement-par-defaut-du-git-push#disqus_thread">Commentaires</a>
<p/>
  <div class="post_prose">
    
  <p>Git est hautement configurable, avec des dizaines de variables possibles
dans le fichier de configuration, la longueur de l'aide de l'option config
donnant d'ailleurs quelques vertiges. Au lieu de faire un (très) long billet
sur les différentes possibilités de configuration, je vous propose plutôt
des billets courts sur un thème particulier de la configuration.</p>
<p>Pour ce premier billet, je souhaite aborder le comportement de Git lors d'un
push. Ce qui ont suivis l'atelier Git à Bordeaux ne seront pas étonnés par ce
choix : ayant totalement oublié cette option, je ne comprenais pas que ma
machine ne se comporte pas comme ceux des participants à l'atelier (ma
crédibilité en tant qu'expert Git en a sérieusement pâti :).</p>
<p>Commençons par lire le manuel sur l'option push.default :</p>
<p>Defines the action git push should take if no refspec is given on the command
line, no refspec is configured in the remote, and no refspec is implied by any
of the options given on the command line. Possible values are: </p>
<ul>
<li>nothing - do not push anything.</li>
<li>matching - push all matching branches. All branches having the same name in
both ends are considered to be matching. This is the default.</li>
<li>upstream - push the current branch to its upstream branch.</li>
<li>tracking - deprecated synonym for upstream.</li>
<li>current - push the current branch to a branch of the same name.</li>
</ul>
<p>Comme vous pouvez le constater, si aucun refspec n'est fourni (en ligne de
commande ou par configuration) le comportement par défaut est de pousser
toutes les branches qui existent en local et sur le serveur. Cela veut donc
dire que si vous tapez la commande <code>git push</code>, vous allez mettre à jour sur le
serveur toutes les branches que vous avez modifié en local, ce qui est rarement
souhaitable. Il faudra indiquer le refspec complet <code>git push origin mybranch</code>
pour éviter cela.</p>
<p>C'est pour cette raison que je configure Git avec l'option upstream :</p>
<blockquote>
<p>$ git config --global push.default upstream</p>
</blockquote>
<p>2 avantages immédiats :</p>
<ul>
<li>Il ne pousse que la branche courante.</li>
<li>Il m'oblige à faire un <em>tracking</em>, ce qui est bien utile.</li>
</ul>
<p>Maintenant, si vous tentez de pousser la branche <em>test</em> avec la commande
<code>git push</code> sans tracking préalable, Git vous répond :</p>
<blockquote>
<p>fatal: The current branch test has no upstream branch.
To push the current branch and set the remote as upstream, use</p>
<p>git push --set-upstream origin test</p>
</blockquote>
<p>Suivez le conseil de Git en tapant la commande ci dessus pour suivre votre
la branche distante test sur origin avec votre branche locale test. Vous verrez
immédiatement un changement sur votre shell avec l'information <strong>u=</strong>, qui 
indique que vos deux branches sont synchronisées.</p>
<h2>Rappel sur le tracking</h2>
<p>Le tracking consiste à <em>associer</em> une branche locale et une branche distante
(dite <em>upstream</em> dans la terminologie Git), ce qui informe Git de la branche
distante à utiliser lors d'un <code>git pull</code>. Si vous ne comprenez pas pourquoi
vous n'êtes pas plus souvent confronté à cette notion de tracking, c'est tout
simplement que Git le fait pour vous la plupart du temps :</p>
<ul>
<li>Git suit la branche master lors d'un clone.</li>
<li>Git suit la branche que vous venez de créer si celle ci existe déjà sur le
   serveur </li>
</ul>
<p>C'est donc (la plupart du temps) dans le cas ou créer une nouvelle branche en
locale sans existance préalable sur le serveur que vous devez explicitement
faire cette association.</p>

  </div>
</div>



  <div class="after_post"><a href="http://www.gitfr.net/blog/2011/12/11/comportement-par-defaut-du-git-push#disqus_thread">Lire et poster des commentaires</a></div>
  <hr class="interblog" />
  
<div class="blog_post">
  <a name="git-1.7.8-publiee"></a>
  <h2 class="blog_post_title"><a href="/blog/2011/12/11/git-1.7.8-publiee" rel="bookmark" title="Permanent Link to Git 1.7.8 publiée">Git 1.7.8 publiée</a></h2>
  <p class="related"><strong>11/12/2011 11:13 PM</strong> | categories: 

<a href='/blog/category/release'>release</a>, <a href='/blog/category/git'>git</a>
 | <a href="http://www.gitfr.net/blog/2011/12/11/git-1.7.8-publiee#disqus_thread">Commentaires</a>
<p/>
  <div class="post_prose">
    
  <p>La version 1.7.8 est sortie le 2 décembre. Comme vous pouvez constater, le
changelog est assez gros avec surtout de nouvelles options pour plusieurs
commandes et l'habituel lot de corrections.</p>
<h2>Le changelog</h2>
<ul>
<li>
<p>Some git-svn, git-gui, git-p4 (in contrib) and msysgit updates.</p>
</li>
<li>
<p>Updates to bash completion scripts.</p>
</li>
<li>
<p>The build procedure has been taught to take advantage of computed
  dependency automatically when the complier supports it.</p>
</li>
<li>
<p>The date parser now accepts timezone designators that lack minutes
  part and also has a colon between "hh:mm".</p>
</li>
<li>
<p>The contents of the /etc/mailname file, if exists, is used as the
  default value of the hostname part of the committer/author e-mail.</p>
</li>
<li>
<p>"git am" learned how to read from patches generated by Hg.</p>
</li>
<li>
<p>"git archive" talking with a remote repository can report errors
  from the remote side in a more informative way.</p>
</li>
<li>
<p>"git branch" learned an explicit --list option to ask for branches
  listed, optionally with a glob matching pattern to limit its output.</p>
</li>
<li>
<p>"git check-attr" learned "--cached" option to look at .gitattributes
  files from the index, not from the working tree.</p>
</li>
<li>
<p>Variants of "git cherry-pick" and "git revert" that take multiple
  commits learned to "--continue" and "--abort".</p>
</li>
<li>
<p>"git daemon" gives more human readble error messages to clients
  using ERR packets when appropriate.</p>
</li>
<li>
<p>Errors at the network layer is logged by "git daemon".</p>
</li>
<li>
<p>"git diff" learned "--minimal" option to spend extra cycles to come
  up with a minimal patch output.</p>
</li>
<li>
<p>"git diff" learned "--function-context" option to show the whole
  function as context that was affected by a change.</p>
</li>
<li>
<p>"git difftool" can be told to skip launching the tool for a path by
  answering 'n' to its prompt.</p>
</li>
<li>
<p>"git fetch" learned to honor transfer.fsckobjects configuration to
  validate the objects that were received from the other end, just like
  "git receive-pack" (the receiving end of "git push") does.</p>
</li>
<li>
<p>"git fetch" makes sure that the set of objects it received from the
  other end actually completes the history before updating the refs.
  "git receive-pack" (the receiving end of "git push") learned to do the
  same.</p>
</li>
<li>
<p>"git fetch" learned that fetching/cloning from a regular file on the
  filesystem is not necessarily a request to unpack a bundle file; the
  file could be ".git" with "gitdir: <path>" in it.</p>
</li>
<li>
<p>"git for-each-ref" learned "%(contents:subject)", "%(contents:body)"
  and "%(contents:signature)". The last one is useful for signed tags.</p>
</li>
<li>
<p>"git grep" used to incorrectly pay attention to .gitignore files
  scattered in the directory it was working in even when "--no-index"
  option was used. It no longer does this. The "--exclude-standard"
  option needs to be given to explicitly activate the ignore
  mechanism.</p>
</li>
<li>
<p>"git grep" learned "--untracked" option, where given patterns are
   searched in untracked (but not ignored) files as well as tracked
   files in the working tree, so that matches in new but not yet
   added files do not get missed.</p>
</li>
<li>
<p>The recursive merge backend no longer looks for meaningless
  existing merges in submodules unless in the outermost merge.</p>
</li>
<li>
<p>"git log" and friends learned "--children" option.</p>
</li>
<li>
<p>"git ls-remote" learned to respond to "-h"(elp) requests.</p>
</li>
<li>
<p>"mediawiki" remote helper can interact with (surprise!) MediaWiki
  with "git fetch" &amp; "git push".</p>
</li>
<li>
<p>"git merge" learned the "--edit" option to allow users to edit the
  merge commit log message.</p>
</li>
<li>
<p>"git rebase -i" can be told to use special purpose editor suitable
  only for its insn sheet via sequence.editor configuration variable.</p>
</li>
<li>
<p>"git send-email" learned to respond to "-h"(elp) requests.</p>
</li>
<li>
<p>"git send-email" allows the value given to sendemail.aliasfile to begin
  with "~/" to refer to the $HOME directory.</p>
</li>
<li>
<p>"git send-email" forces use of Authen::SASL::Perl to work around
  issues between Authen::SASL::Cyrus and AUTH PLAIN/LOGIN.</p>
</li>
<li>
<p>"git stash" learned "--include-untracked" option to stash away
  untracked/ignored cruft from the working tree.</p>
</li>
<li>
<p>"git submodule clone" does not leak an error message to the UI
  level unnecessarily anymore.</p>
</li>
<li>
<p>"git submodule update" learned to honor "none" as the value for
  submodule.<name>.update to specify that the named submodule should
  not be checked out by default.</p>
</li>
<li>
<p>When populating a new submodule directory with "git submodule init",
  the $GIT_DIR metainformation directory for submodules is created inside
  $GIT_DIR/modules/<name>/ directory of the superproject and referenced
  via the gitfile mechanism. This is to make it possible to switch
  between commits in the superproject that has and does not have the
  submodule in the tree without re-cloning.</p>
</li>
<li>
<p>"gitweb" leaked unescaped control characters from syntax hiliter
  outputs.</p>
</li>
<li>
<p>"gitweb" can be told to give custom string at the end of the HTML
  HEAD element.</p>
</li>
<li>
<p>"gitweb" now has its own manual pages.</p>
</li>
<li>
<p>HTTP transport did not use pushurl correctly, and also did not tell
  what host it is trying to authenticate with when asking for
  credentials.
  (merge deba493 jk/http-auth later to maint).</p>
</li>
<li>
<p>"git blame" was aborted if started from an uncommitted content and
  the path had the textconv filter in effect.
  (merge 8518088 ss/blame-textconv-fake-working-tree later to maint).</p>
</li>
<li>
<p>Adding many refs to the local repository in one go (e.g. "git fetch"
  that fetches many tags) and looking up a ref by name in a repository
  with too many refs were unnecessarily slow.
  (merge 17d68a54d jp/get-ref-dir-unsorted later to maint).</p>
</li>
<li>
<p>Report from "git commit" on untracked files was confused under
  core.ignorecase option.
  (merge 395c7356 jk/name-hash-dirent later to maint).</p>
</li>
<li>
<p>"git merge" did not understand ":/<pattern>" as a way to name a commit.</p>
</li>
<li>
<p>"git push" on the receiving end used to call post-receive and post-update
  hooks for attempted removal of non-existing refs.
  (merge 160b81ed ph/push-to-delete-nothing later to maint).</p>
</li>
<li>
<p>Help text for "git remote set-url" and "git remote set-branches"
  were misspelled.
  (merge c49904e fc/remote-seturl-usage-fix later to maint).
  (merge 656cdf0 jc/remote-setbranches-usage-fix later to maint).</p>
</li>
</ul>

  </div>
</div>



  <div class="after_post"><a href="http://www.gitfr.net/blog/2011/12/11/git-1.7.8-publiee#disqus_thread">Lire et poster des commentaires</a></div>
  <hr class="interblog" />
  
<div class="blog_post">
  <a name="presentation-et-atelier-git-le-15-12-a-lille"></a>
  <h2 class="blog_post_title"><a href="/blog/2011/12/01/presentation-et-atelier-git-le-15-12-a-lille" rel="bookmark" title="Permanent Link to Présentation et atelier Git le 15/12 à Lille">Présentation et atelier Git le 15/12 à Lille</a></h2>
  <p class="related"><strong>01/12/2011 01:07 PM</strong> | categories: 

<a href='/blog/category/atelier'>atelier</a>, <a href='/blog/category/gitfr'>gitfr</a>
 | <a href="http://www.gitfr.net/blog/2011/12/01/presentation-et-atelier-git-le-15-12-a-lille#disqus_thread">Commentaires</a>
<p/>
  <div class="post_prose">
    
  <p>Si vous êtes sur Lille ou sa région et que vous voulez apprendre Git, réservez
votre 15 décembre ! Au programme, 3h (voir plus si les participants sont
motivés) avec en entrée une présentation de Git, suivi d'un atelier pour
débutant.</p>
<p>Je vous avoue que 3h pour une présentation et un atlier est un peu court, mais
cela me suffit pour vous donner une idée assez précise des possbilités de
l'outil :).</p>
<p>Cet événement est organisé par Ineat Conseil et cela se passera dans leur
locaux. Les places sont donc limitées !</p>
<p>L'inscription se fait sur cette <a href="http://ineat-conseil-git-estw.eventbrite.com/">page</a>.</p>
<p><strong>Rappel</strong> : les participants doivent venir avec Git déjà installé sur leur
poste.</p>

  </div>
</div>



  <div class="after_post"><a href="http://www.gitfr.net/blog/2011/12/01/presentation-et-atelier-git-le-15-12-a-lille#disqus_thread">Lire et poster des commentaires</a></div>
  <hr class="interblog" />
  
<div class="blog_post">
  <a name="presentation-git-le-14-12-a-paris"></a>
  <h2 class="blog_post_title"><a href="/blog/2011/12/01/presentation-git-le-14-12-a-paris" rel="bookmark" title="Permanent Link to Présentation Git le 14/12 à Paris">Présentation Git le 14/12 à Paris</a></h2>
  <p class="related"><strong>01/12/2011 01:02 PM</strong> | categories: 

<a href='/blog/category/atelier'>atelier</a>, <a href='/blog/category/gitfr'>gitfr</a>
 | <a href="http://www.gitfr.net/blog/2011/12/01/presentation-git-le-14-12-a-paris#disqus_thread">Commentaires</a>
<p/>
  <div class="post_prose">
    
  <p>Avant dernière conférence de l'année 2011, organisé par l'association
<a href="http://www.altnetfr.org/">alt.netFR</a>. Si vous êtes sur Paris, c'est votre
dernière chance de me voir en live avant un bon bout de temps ! C'est Valtech
qui accueille cette fois ci dans une grande salle pouvant accueillir plus de
100 personnes.<br />
</p>
<p>L'inscription se fait sur cette <a href="http://www.eventbrite.com/event/2421871884">page</a>.</p>
<p>Pour l'anectode, je suis depuis 16 ans un grand fan d'Unix et du Logiciel Libre
et je déteste Windows. je crois que ça va basher plus fort que d'habitude ;).</p>

  </div>
</div>



  <div class="after_post"><a href="http://www.gitfr.net/blog/2011/12/01/presentation-git-le-14-12-a-paris#disqus_thread">Lire et poster des commentaires</a></div>
  <hr class="interblog" />
  
<div class="blog_post">
  <a name="atelier-prive-hg-vs-git-le-03-12-a-paris"></a>
  <h2 class="blog_post_title"><a href="/blog/2011/12/01/atelier-prive-hg-vs-git-le-03-12-a-paris" rel="bookmark" title="Permanent Link to Atelier privé Hg vs Git le 03/12 à Paris">Atelier privé Hg vs Git le 03/12 à Paris</a></h2>
  <p class="related"><strong>01/12/2011 10:48 AM</strong> | categories: 

<a href='/blog/category/atelier'>atelier</a>, <a href='/blog/category/gitfr'>gitfr</a>
 | <a href="http://www.gitfr.net/blog/2011/12/01/atelier-prive-hg-vs-git-le-03-12-a-paris#disqus_thread">Commentaires</a>
<p/>
  <div class="post_prose">
    
  <p>Un atelier un peu particulier se déroulera le samedi 03 à 15h, et ce pour deux
raisons :</p>
<ul>
<li>C'est à destination de mes amis de l'AFPy (association Python francophone).</li>
<li>Les participants sont tous des utilisateurs de DVCS : principalement Hg (étant
  lui même en Python, c'est le choix du projet CPython et de beaucoup de 
  développeurs Python) et dans une moindre mesure Bzr et Git.</li>
</ul>
<p>Pour l'anectode, j'avais tanné (et le mot est faible) les mêmes pour abondonner
SVN pour Hg[1] il y'a de ça quelques années. Maintenant, je recommence pour
passer à Git ;).</p>
<p>L'objectif est triple :</p>
<ul>
<li>Montrer à quel point Git déchire sa race :).</li>
<li>Comparer Git / Hg / Bzr par des praticiens de ces 3 outils.</li>
<li>Apprendre les évolutions de Hg depuis que je ne l'utilise plus. Et si possible
  Bzr que je n'ai jamais utilisé.</li>
</ul>
<p>Pour le déroulement, je vais commencer par ma présentation classique mais sans
les sections sur SVN (ils sont tous convaincus, inutile d'en parler) : la notion
de workflows des DVCS puis théorie de Git et les commandes qui déchirent. Puis
atelier Git.</p>
<p>Je risque d'être un peu malmené cette fois ci, les participants étant loin
d'être des novices :). Mais l'ambiance bonne enfant (on se connait tous pour la
plupart depuis des années) et les compétences de chacun rendra l'atelier je suis
sûr fort intéressant. </p>
<p>Je tente de faire un compte rendu juste après.</p>
<p>[1] Pour être exact, pour passer aux DVCS en général. A l'époque, j'étais sur
Hg mais je n'avais pas vraiment de préférence marquée pour l'un des trois. Ce
qui n'est plus le cas depuis que je connais Git.</p>

  </div>
</div>



  <div class="after_post"><a href="http://www.gitfr.net/blog/2011/12/01/atelier-prive-hg-vs-git-le-03-12-a-paris#disqus_thread">Lire et poster des commentaires</a></div>
  <hr class="interblog" />
  
<div class="blog_post">
  <a name="retour-sur-l-atelier-du-20-10"></a>
  <h2 class="blog_post_title"><a href="/blog/2011/10/23/retour-sur-l-atelier-du-20-10" rel="bookmark" title="Permanent Link to Retour sur l'atelier du 20/10">Retour sur l'atelier du 20/10</a></h2>
  <p class="related"><strong>23/10/2011 08:20 PM</strong> | categories: 

<a href='/blog/category/atelier'>atelier</a>, <a href='/blog/category/gitfr'>gitfr</a>
 | <a href="http://www.gitfr.net/blog/2011/10/23/retour-sur-l-atelier-du-20-10#disqus_thread">Commentaires</a>
<p/>
  <div class="post_prose">
    
  <p>Petit retour qui intéressera peut être les personnes qui souhaitent aussi
faire des ateliers Git. Je ne suis pas très satisfait de mon 2eme atelier
plusieurs raisons :</p>
<ol>
<li>
<p>C'était mon 1er atelier qui ne suit pas directement la conférence. Je ne
   connaissais donc pas le niveau des participants. Moralité, j'ai rabaché
   ma prés, au lieu de considérer qu'elle était acquise.</p>
</li>
<li>
<p>Conséquence du point précédent, les participants ont passés plus de temps à
   m'écouter qu'a travailler sur leurs machines. Il faut donc que je m'oblige à
   me taire et attendre que les participants essayent les commandes.</p>
</li>
<li>
<p>Je pense qu'il est bon de faire les démos avec un dépôt réel dés qu'on arrive
   à la partie «cas d'utilisation».</p>
</li>
</ol>
<p>Pour le dernier point, je suis partagé sur la solution à adopter :</p>
<ul>
<li>
<p>Créer un dépôt spécial pour l'atelier, avec du contenu texte par exemple.</p>
</li>
<li>
<p>Partager un dépôt de code que je possède.</p>
</li>
<li>
<p>Demander aux participants de venir avec leur code.</p>
</li>
</ul>
<p>Vous en pensez quoi ?</p>

  </div>
</div>



  <div class="after_post"><a href="http://www.gitfr.net/blog/2011/10/23/retour-sur-l-atelier-du-20-10#disqus_thread">Lire et poster des commentaires</a></div>
  <hr class="interblog" />
  
<div class="blog_post">
  <a name="presentation-git-le-24-11-a-bordeaux"></a>
  <h2 class="blog_post_title"><a href="/blog/2011/10/13/presentation-git-le-24-11-a-bordeaux" rel="bookmark" title="Permanent Link to Présentation Git le 24/11 à Bordeaux">Présentation Git le 24/11 à Bordeaux</a></h2>
  <p class="related"><strong>13/10/2011 01:40 AM</strong> | categories: 

<a href='/blog/category/atelier'>atelier</a>, <a href='/blog/category/gitfr'>gitfr</a>
 | <a href="http://www.gitfr.net/blog/2011/10/13/presentation-git-le-24-11-a-bordeaux#disqus_thread">Commentaires</a>
<p/>
  <div class="post_prose">
    
  <p>Nouvelle étape du tour de France avec la bonne ville de Bordeaux, pour un
combo présentation et atelier sur 2 jours : </p>
<ul>
<li>Présentation le 24/11</li>
<li>Atelier le 25/11</li>
</ul>
<p><strong>MAJ</strong> : Vous pouvez vous inscrire à la soirée sur site du
<a href="http://bordeauxjug.org/20111124_SoireeGit">BordeauxJUG</a>, organisateur
de l'événement.</p>

  </div>
</div>



  <div class="after_post"><a href="http://www.gitfr.net/blog/2011/10/13/presentation-git-le-24-11-a-bordeaux#disqus_thread">Lire et poster des commentaires</a></div>
  <hr class="interblog" />
  
<div class="blog_post">
  <a name="comprendre-le-refspec"></a>
  <h2 class="blog_post_title"><a href="/blog/2011/10/09/comprendre-le-refspec" rel="bookmark" title="Permanent Link to Comprendre le refspec">Comprendre le refspec</a></h2>
  <p class="related"><strong>09/10/2011 05:53 PM</strong> | categories: 

<a href='/blog/category/git'>git</a>, <a href='/blog/category/refspec'>refspec</a>, <a href='/blog/category/git-push'>git-push</a>, <a href='/blog/category/git-pull'>git-pull</a>, <a href='/blog/category/git-fetch'>git-fetch</a>, <a href='/blog/category/git-remote'>git-remote</a>, <a href='/blog/category/git-clone'>git-clone</a>
 | <a href="http://www.gitfr.net/blog/2011/10/09/comprendre-le-refspec#disqus_thread">Commentaires</a>
<p/>
  <div class="post_prose">
    
  <p>Si vous avez déjà travaillé avec un dépôt distant, vous savez comment se
comporte Git : il vous indique les références du dépôt distant en
ajoutant l'espace de nom <code>origin</code> (dans le cas d'un clone) ou le nom que
vous lui donnez si vous l'avez ajouter avec la commande <code>git-remote add</code>.
Mais pourquoi Git a t'il ce comportement ?</p>
<p>La réponse se trouve dans le <strong>refspec</strong>, nom un peu barbare, qui pourrait
se traduire en bon français par : «comment je gère les dépôts distants
chef ?». Soit ce refspec est spécifié en ligne de commande au moment
de l'action (fetch ou push), soit elle se trouve dans le fichier de
configuration du dépôt.</p>
<h2>Petit rappel</h2>
<p>Il est <strong>impossible</strong> de modifer directement un dépôt distant, vous devez
obligatoirement modifier le dépôt local puis pousser vos commits
sur le dépôt distant. Autrement dit, modifier un dépôt consiste à
synchroniser les bases de données.</p>
<p>C'est là que le refspec rentre en jeu, il permet de définir les branches
concernées au moment de la synchronisation.</p>
<h2>Clonage</h2>
<p>Si vous joué rarement avec le refspec, c'est que vous travaillé la plupart
du temps sur un dépôt local que vous avez créé avec la commande <code>git-clone</code>.
Ce dernier génère un refspec générique suffisant. Editez le fichier
<code>.git/config</code> et vous verrez ces lignes :</p>
<pre><code>[remote "origin"]
fetch = +refs/heads/*:refs/remotes/origin/*
url = /path/to/repos
</code></pre>
<p>Une explication rapide : le dépôt distant qui se trouve à l'url spécifié
s'appelle en local <em>origin</em> et on associe à chaque référence de branche
du dépôt distant une référence de branche locale préfixée par <em>origin</em>.</p>
<p>Mais un deuxième rappel avant d'aller plus loin.</p>
<h2>Structure des références</h2>
<p>La gestion des références est d'une simplicité affligeante. Tout est contenu
dans le répertoire <code>.git/refs</code>. Un répertoire étant un espace de nom, un
fichier une référence. Pour fonctionner, Git à besoin de 2 espaces de nom
bien particulier :</p>
<ul>
<li>
<p><em>heads</em> pour stocker les références locales de type branche.</p>
</li>
<li>
<p><em>tags</em> pour stocker les références locales de type tag.</p>
</li>
</ul>
<p>Vous ne faites pas attention à ces répertoires en temps normal car les
commandes Git savent pertinamment que les références sont à ces endroits
précis.</p>
<h2>Explication</h2>
<p>Si je vous dis qu'un refspec s'écrit toujours <code>source:destination</code>, la ligne
suivante ne doit pas vous poser trop de soucis. Examinons la de plus prêt :</p>
<blockquote>
<p>fetch = +refs/heads/<em>:refs/remotes/origin/</em></p>
</blockquote>
<ul>
<li>
<p>Le mot clé fetch indique que c'est lu à chaque utilisation de cette commande
  Le sens de transfert est du dépôt distant (la source) vers le dépôt local
  (la destination).</p>
</li>
<li>
<p>Le symbole <code>+</code> signifie qu'on autorise les récuparation <em>non fast-forword</em>.</p>
</li>
<li>
<p>le reste de la ligne est assez explicite. Pour toutes les références se
  trouvant dans le chemin <code>refs/heads/</code> dans le dépôt distant, on associe une
  référence dans le chemin <code>refs/remotes/origin/</code> dans le dépot local. </p>
</li>
</ul>
<p>Si par exemple le dépôt distant a 3 branches qui se nomment <code>riri</code>, <code>fifi</code> et
<code>loulou</code>, vous aurez donc en local 3 branches <code>origin/riri</code>, <code>origin/fifi</code> et
<code>origin/loulou</code>.</p>
<h2>Importance du refspec</h2>
<p>Il est important de maitriser le refspec car tout part de là, c'est en fonction
des références à récupérer ou à pousser que Git détermine les objets à 
synchroniser. Si je demande à récupérer toutes les références distantes, je demande
implicitement tous les objets accessibles par ces références, donc toute la base.
Au contraire, si le refspec implique des références précises, seuls les objets
nécessaires à ces références seront impactés.</p>
<h2>Ajout d'un dépôt distant</h2>
<p>La commande <code>git-remote</code> permet de manipuler les dépôts distants, avec
notamment la commande <code>git-remote add</code> pour en ajouter. Ce dernier se comporte
comme la commande <code>git-clone</code>, en configurant le refspec au plus
large (toutes les références donc).</p>
<h2>refspec en ligne de commande</h2>
<p>Le refspec se manipule aussi en ligne de commande, ce qui permet de passer
outre la configuration ou d'utiliser Git sans configuration préalable.</p>
<p>Quelques exemples :</p>
<blockquote>
<p>git fetch origin +pu:tmp</p>
</blockquote>
<p>Récupére la référence <em>pu</em> et les objets associés et appeles la <em>tmp</em>
en local.</p>
<blockquote>
<p>git push HEAD:master</p>
</blockquote>
<p>Pousse la branche actuelle sur la branche distante master.</p>
<blockquote>
<p>git push origin master:refs/heads/qa/experimental</p>
</blockquote>
<p>Pousse la branche master sur la branche distante expérimental. Nous
utilisons ici le nom complet de la référence. </p>
<h2>Le refspec :</h2>
<p>Refspec particulier qui indique de mettre à jour toutes les branches
distantes existantes qui ont un nom identique aux branches locales. C'est en
fait le refspec utilisé par défaut au push quand nous en spécifions pas.</p>
<h2>Effacer une référence distante</h2>
<p>Autre cas particulier. Si vous souhaitez par exemple effacer la référence
distante test si vous souhaitez effacer une référence distante,
il faut taper :</p>
<blockquote>
<p>git push :test</p>
</blockquote>
<p>Autrement dit, je pousse une référence vide sur la référence test.</p>
<h2>Associer branche locale / branche distante</h2>
<p>Comme nous l'avons vu, le refspec en ligne de commande permet d'associer
temporairement une branche locale et une branche sur le dépôt distant. Mais
comment associer ces deux branches dans la configuration et éviter ainsi de
le répêter à chaque fois ? Tout se situe encore dans le fichier
<code>.git/config</code> du dépôt local :</p>
<pre><code>[branch "master"]                                                                                   
remote = origin                                                                             
merge = refs/heads/master
</code></pre>
<p>Qui veut dire : associe la branche master du dépôt <em>origin</em> à ma référence
locale <code>master</code>. Et oh surprise, la ligne est utilisée pour la commande
<code>merge</code>, ce qui est tout à faire logique. la commande <code>git-fetch</code> ne fait que
récupérer les objets et associer des références. Si vous voulez mélanger
votre travail avec le travail distant, il faut donc faire un merge.</p>
<p>Petite remarque, c'est uniquement quand vous avez spécifiée une branche
distante (<em>upstream</em> dans le vocabulaire Git) que votre shell vous indiquera
si vous avez des commits en avance ou en retard (logique non ?). Cela arrive
quand vous avez créé une nouvelle branche locale mais sans l'avoir poussée
sur le dépôt distant.</p>
<h2>pull = fetch + merge</h2>
<p>Vous devez maintenant comprendre pourquoi on dit que la commande <code>git-pull</code>
n'est en fait qu'un raccouri pour :</p>
<ol>
<li>git-fetch</li>
<li>git-merge origin/master</li>
</ol>
<h2>A quoi sert le fetch ?</h2>
<p>La commande <code>git-pull</code> est une commodité car c'est dans 90% des cas ce que l'on
souhaite faire. Mais le merge est seulement une des nombreuses possibilités que
vous offre Git. La beauté du travail collaboratif avec Git est que cette branche
distante est en fait une branche locale (c'est uniquement la référence qui est
distante), et que vous pouvez donc faire ce que vous souhaitez avec, comme
cherrypicker des commits, faire un rebase... ou un merge. C'est à vous de voir
ce qui vous intéresse. C'est la raison pour laquelle des personnes disent sur
le Net de ne pas faire que des fetch.</p>
<p>Notez qu'il existe l'option <code>--rebase</code> pour rebaser automatiquement votre
branche locale sur la branche distante (ce qui est la aussi un scénario de
base).</p>
<h2>Conclusion</h2>
<p>Je pense avoir fait le tour. Comme d'habitude je vous conseille de de lire
les pages du manuel (git-clone, git-fetch, git-push et git-pull).</p>

  </div>
</div>



  <div class="after_post"><a href="http://www.gitfr.net/blog/2011/10/09/comprendre-le-refspec#disqus_thread">Lire et poster des commentaires</a></div>
  <hr class="interblog" />
 <a href="/blog/page/2">Articles précédents »</a>

        </div><!-- End Prose Block -->
        
  <div class="right_sidebar">
    <div id="right_sidebar">
  <div id="rss">
    <h2>flux RSS</h2>
    <a href="http://feeds.feedburner.com/gitfr">billets</a>
    /
    <a href="http://gitfr.disqus.com/latest.rss">commentaires</a>
  </div>
  <div id="contact">
    <h2>Contact</h2>
    mail : seb@gitfr.net<br />
    liste de diffusion : <a href="http://groups.google.com/group/gitfr">gitfr</a><br />
    IRC : #git-fr sur Freenode
  </div>
  <div id="blog_post_list">
    <h2>Derniers billets</h2>
    <ul>
    <li><a href="/blog/2011/12/11/comportement-par-defaut-du-git-push">Comportement par défaut du git push</a></li>
    <li><a href="/blog/2011/12/11/git-1.7.8-publiee">Git 1.7.8 publiée</a></li>
    <li><a href="/blog/2011/12/01/presentation-et-atelier-git-le-15-12-a-lille">Présentation et atelier Git le 15/12 à Lille</a></li>
    <li><a href="/blog/2011/12/01/presentation-git-le-14-12-a-paris">Présentation Git le 14/12 à Paris</a></li>
    <li><a href="/blog/2011/12/01/atelier-prive-hg-vs-git-le-03-12-a-paris">Atelier privé Hg vs Git le 03/12 à Paris</a></li>
    <li><a href="/blog/2011/10/23/retour-sur-l-atelier-du-20-10">Retour sur l'atelier du 20/10</a></li>
    <li><a href="/blog/2011/10/13/presentation-git-le-24-11-a-bordeaux">Présentation Git le 24/11 à Bordeaux</a></li>
    <li><a href="/blog/2011/10/09/comprendre-le-refspec">Comprendre le refspec</a></li>
  </ul>
  </div>
  <div id="on_twitter">
    <h3>Sur Twitter</h2>
    <div id="blogofile_tweets"></div>
    <a href="http://twitter.com/gitfr" style="float: right">Plus de tweets</a>
  </div>
  <div id="categories">
    <h2>Categories</h2>
    <ul>
     <li><a href="/blog/category/astuce">astuce</a> (<a href="/blog/category/astuce/feed">rss</a>) (1)</li>
     <li><a href="/blog/category/atelier">atelier</a> (<a href="/blog/category/atelier/feed">rss</a>) (20)</li>
     <li><a href="/blog/category/configuration">configuration</a> (<a href="/blog/category/configuration/feed">rss</a>) (7)</li>
     <li><a href="/blog/category/git">git</a> (<a href="/blog/category/git/feed">rss</a>) (53)</li>
     <li><a href="/blog/category/git-add">git-add</a> (<a href="/blog/category/git-add/feed">rss</a>) (1)</li>
     <li><a href="/blog/category/git-checkout">git-checkout</a> (<a href="/blog/category/git-checkout/feed">rss</a>) (1)</li>
     <li><a href="/blog/category/git-clone">git-clone</a> (<a href="/blog/category/git-clone/feed">rss</a>) (2)</li>
     <li><a href="/blog/category/git-commit">git-commit</a> (<a href="/blog/category/git-commit/feed">rss</a>) (1)</li>
     <li><a href="/blog/category/git-fetch">git-fetch</a> (<a href="/blog/category/git-fetch/feed">rss</a>) (1)</li>
     <li><a href="/blog/category/git-init">git-init</a> (<a href="/blog/category/git-init/feed">rss</a>) (1)</li>
     <li><a href="/blog/category/git-pull">git-pull</a> (<a href="/blog/category/git-pull/feed">rss</a>) (2)</li>
     <li><a href="/blog/category/git-push">git-push</a> (<a href="/blog/category/git-push/feed">rss</a>) (2)</li>
     <li><a href="/blog/category/git-remote">git-remote</a> (<a href="/blog/category/git-remote/feed">rss</a>) (1)</li>
     <li><a href="/blog/category/git-reset">git-reset</a> (<a href="/blog/category/git-reset/feed">rss</a>) (1)</li>
     <li><a href="/blog/category/git-revert">git-revert</a> (<a href="/blog/category/git-revert/feed">rss</a>) (1)</li>
     <li><a href="/blog/category/git-rm">git-rm</a> (<a href="/blog/category/git-rm/feed">rss</a>) (1)</li>
     <li><a href="/blog/category/gitfr">gitfr</a> (<a href="/blog/category/gitfr/feed">rss</a>) (24)</li>
     <li><a href="/blog/category/github">github</a> (<a href="/blog/category/github/feed">rss</a>) (11)</li>
     <li><a href="/blog/category/google-code">google code</a> (<a href="/blog/category/google-code/feed">rss</a>) (1)</li>
     <li><a href="/blog/category/hg">hg</a> (<a href="/blog/category/hg/feed">rss</a>) (1)</li>
     <li><a href="/blog/category/installation">installation</a> (<a href="/blog/category/installation/feed">rss</a>) (3)</li>
     <li><a href="/blog/category/macos">macos</a> (<a href="/blog/category/macos/feed">rss</a>) (2)</li>
     <li><a href="/blog/category/migration">migration</a> (<a href="/blog/category/migration/feed">rss</a>) (6)</li>
     <li><a href="/blog/category/outil">outil</a> (<a href="/blog/category/outil/feed">rss</a>) (4)</li>
     <li><a href="/blog/category/refspec">refspec</a> (<a href="/blog/category/refspec/feed">rss</a>) (2)</li>
     <li><a href="/blog/category/release">release</a> (<a href="/blog/category/release/feed">rss</a>) (18)</li>
     <li><a href="/blog/category/traduction">traduction</a> (<a href="/blog/category/traduction/feed">rss</a>) (1)</li>
     <li><a href="/blog/category/ubuntu">ubuntu</a> (<a href="/blog/category/ubuntu/feed">rss</a>) (1)</li>
     <li><a href="/blog/category/windows">windows</a> (<a href="/blog/category/windows/feed">rss</a>) (2)</li>
    </ul>
  </div> 
  <div id="archives">			
    <h2>Archives</h2>
    <ul>
      <li><a href="/blog/archive/2011/12/1" title="December 2011">December 2011</a>&nbsp;(5)</li>
      <li><a href="/blog/archive/2011/10/1" title="October 2011">October 2011</a>&nbsp;(7)</li>
      <li><a href="/blog/archive/2011/09/1" title="September 2011">September 2011</a>&nbsp;(1)</li>
      <li><a href="/blog/archive/2011/08/1" title="August 2011">August 2011</a>&nbsp;(2)</li>
      <li><a href="/blog/archive/2011/07/1" title="July 2011">July 2011</a>&nbsp;(5)</li>
      <li><a href="/blog/archive/2011/06/1" title="June 2011">June 2011</a>&nbsp;(6)</li>
      <li><a href="/blog/archive/2011/05/1" title="May 2011">May 2011</a>&nbsp;(2)</li>
      <li><a href="/blog/archive/2011/04/1" title="April 2011">April 2011</a>&nbsp;(23)</li>
      <li><a href="/blog/archive/2011/03/1" title="March 2011">March 2011</a>&nbsp;(4)</li>
      <li><a href="/blog/archive/2011/02/1" title="February 2011">February 2011</a>&nbsp;(3)</li>
      <li><a href="/blog/archive/2011/01/1" title="January 2011">January 2011</a>&nbsp;(1)</li>
      <li><a href="/blog/archive/2010/12/1" title="December 2010">December 2010</a>&nbsp;(12)</li>
      <li><a href="/blog/archive/2010/11/1" title="November 2010">November 2010</a>&nbsp;(12)</li>
      <li><a href="/blog/archive/2010/10/1" title="October 2010">October 2010</a>&nbsp;(3)</li>
    </ul>
  </div>
  <div id="credits">
    <h2>Crédits</h2>
    Propulsé par <a href="http://www.blogofile.com">Blogofile</a>
  </div>

</div>

  </div>

      </div><!-- End Main Block -->
    </div> <!-- End Content -->

    <script type="text/javascript">
  
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-19444937-1']);
        _gaq.push(['_trackPageview']);

        (function() {
            var ga = document.createElement('script');
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            ga.setAttribute('async', 'true');
            document.documentElement.firstChild.appendChild(ga);
        })();

    </script>
  </body>
</html>





